<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙØ§ØªÙˆØ±Ø© Ù…Ø¨ÙŠØ¹Ø§Øª - {{ sale.invoice_number }}</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            font-size: 14px;
            direction: rtl;
            background: white;
        }
        
        .invoice-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border: 1px solid #ddd;
        }
        
        .header {
            text-align: center;
            border-bottom: 3px solid #2c3e50;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .company-logo {
            font-size: 28px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .company-info {
            color: #666;
            line-height: 1.8;
            font-size: 12px;
        }
        
        .invoice-title {
            background: #3498db;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .invoice-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        
        .invoice-info, .customer-info {
            flex: 1;
            padding: 15px;
            background: #f8f9fa;
            margin: 0 5px;
            border-radius: 5px;
        }
        
        .invoice-info h4, .customer-info h4 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            border: 2px solid #2c3e50;
        }
        
        .items-table th {
            background: #2c3e50;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
        }
        
        .items-table td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
        
        .items-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .totals-section {
            float: left;
            width: 350px;
            margin-top: 20px;
        }
        
        .totals-table {
            width: 100%;
            border-collapse: collapse;
            border: 2px solid #2c3e50;
        }
        
        .totals-table td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .totals-table .label {
            background: #ecf0f1;
            font-weight: bold;
            text-align: right;
        }
        
        .totals-table .amount {
            text-align: left;
            font-weight: bold;
        }
        
        .final-total {
            background: #3498db !important;
            color: white !important;
            font-size: 16px;
        }
        
        .footer {
            clear: both;
            margin-top: 50px;
            text-align: center;
            padding-top: 20px;
            border-top: 2px solid #2c3e50;
            color: #666;
        }
        
        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        
        .signature-box {
            width: 200px;
            text-align: center;
        }
        
        .signature-line {
            border-bottom: 2px solid #2c3e50;
            margin-bottom: 10px;
            height: 50px;
        }
        
        @media print {
            body { margin: 0; }
            .no-print { display: none; }
        }
        
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .print-button:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <button class="print-button no-print" onclick="window.print()">
        ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©
    </button>
    
    <div class="invoice-container">
        <!-- Ø±Ø£Ø³ Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
        <div class="header">
            <div class="company-logo">Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</div>
            <div class="company-info">
                Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©<br>
                Ù‡Ø§ØªÙ: +966 11 123 4567 | ÙØ§ÙƒØ³: +966 11 123 4568<br>
                Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: info@accounting.com | Ù…ÙˆÙ‚Ø¹: www.accounting.com<br>
                Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ: 123456789012345
            </div>
        </div>
        
        <!-- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
        <div class="invoice-title">
            ÙØ§ØªÙˆØ±Ø© Ù…Ø¨ÙŠØ¹Ø§Øª
        </div>
        
        <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
        <div class="invoice-details">
            <div class="invoice-info">
                <h4>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø©</h4>
                <p><strong>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</strong> {{ sale.invoice_number }}</p>
                <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</strong> {{ sale.invoice_date.strftime('%Y-%m-%d') }}</p>
                <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:</strong> {{ sale.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
                <p><strong>Ø§Ù„ÙØ±Ø¹:</strong> {{ sale.branch.name if sale.branch else 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</p>
                <p><strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</strong> {{ sale.payment_method }}</p>
            </div>
            
            <div class="customer-info">
                <h4>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h4>
                {% if sale.customer %}
                <p><strong>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„:</strong> {{ sale.customer.name }}</p>
                <p><strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> {{ sale.customer.phone or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</p>
                <p><strong>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</strong> {{ sale.customer.address or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</p>
                <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</strong> {{ sale.customer.email or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</p>
                {% else %}
                <p><strong>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„:</strong> Ø¹Ù…ÙŠÙ„ Ù†Ù‚Ø¯ÙŠ</p>
                <p><strong>Ø§Ù„ÙˆØµÙ:</strong> Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹ Ù†Ù‚Ø¯ÙŠØ© Ù…Ø¨Ø§Ø´Ø±Ø©</p>
                {% endif %}
            </div>
        </div>
        
        <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£ØµÙ†Ø§Ù -->
        <table class="items-table">
            <thead>
                <tr>
                    <th width="10%">#</th>
                    <th width="40%">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</th>
                    <th width="15%">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                    <th width="15%">Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©</th>
                    <th width="20%">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                </tr>
            </thead>
            <tbody>
                {% for item in sale_items %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ item.product.name if item.product else 'Ù…Ù†ØªØ¬ Ù…Ø­Ø°ÙˆÙ' }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>{{ "%.2f"|format(item.unit_price) }} Ø±ÙŠØ§Ù„</td>
                    <td>{{ "%.2f"|format(item.total_price) }} Ø±ÙŠØ§Ù„</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <!-- Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª -->
        <div class="totals-section">
            <table class="totals-table">
                <tr>
                    <td class="label">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ:</td>
                    <td class="amount">{{ "%.2f"|format(sale.total_amount) }} Ø±ÙŠØ§Ù„</td>
                </tr>
                <tr>
                    <td class="label">Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (15%):</td>
                    <td class="amount">{{ "%.2f"|format(sale.tax_amount) }} Ø±ÙŠØ§Ù„</td>
                </tr>
                <tr class="final-total">
                    <td class="label">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</td>
                    <td class="amount">{{ "%.2f"|format(sale.final_amount) }} Ø±ÙŠØ§Ù„</td>
                </tr>
                {% if sale.paid_amount and sale.paid_amount > 0 %}
                <tr>
                    <td class="label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹:</td>
                    <td class="amount">{{ "%.2f"|format(sale.paid_amount) }} Ø±ÙŠØ§Ù„</td>
                </tr>
                <tr>
                    <td class="label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</td>
                    <td class="amount">{{ "%.2f"|format(sale.final_amount - sale.paid_amount) }} Ø±ÙŠØ§Ù„</td>
                </tr>
                {% endif %}
            </table>
        </div>
        
        <!-- Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª -->
        <div class="signature-section">
            <div class="signature-box">
                <div class="signature-line"></div>
                <strong>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„</strong>
            </div>
            <div class="signature-box">
                <div class="signature-line"></div>
                <strong>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</strong>
            </div>
        </div>
        
        <!-- ØªØ°ÙŠÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
        <div class="footer">
            <p><strong>Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ¹Ø§Ù…Ù„ÙƒÙ… Ù…Ø¹Ù†Ø§</strong></p>
            <p>Ù‡Ø°Ù‡ ÙØ§ØªÙˆØ±Ø© Ù…ÙÙ†Ø´Ø£Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹ ÙˆÙ„Ø§ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªÙˆÙ‚ÙŠØ¹ Ø£Ùˆ Ø®ØªÙ…</p>
            <p>ÙÙŠ Ø­Ø§Ù„Ø© ÙˆØ¬ÙˆØ¯ Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© Ø£Ø¹Ù„Ø§Ù‡</p>
            <p style="font-size: 10px; color: #999;">
                ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨ÙˆØ§Ø³Ø·Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - {{ sale.created_at.strftime('%Y-%m-%d %H:%M:%S') }}
            </p>
        </div>
    </div>
    
    <script>
        // Ø·Ø¨Ø§Ø¹Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        window.onload = function() {
            // ØªØ£Ø®ÙŠØ± Ù‚ØµÙŠØ± Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ÙƒØ§Ù…Ù„Ø©
            setTimeout(function() {
                window.print();
            }, 500);
        };
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
        window.onafterprint = function() {
            window.close();
        };
    </script>
</body>
</html>
