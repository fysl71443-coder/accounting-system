{% extends "base_unified.html" %}

{% block title %}
    {% if session.get('language', 'ar') == 'ar' %}
        Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©
    {% else %}
        Customers Management - Accounting System
    {% endif %}
{% endblock %}

{% block page_icon %}<i class="fas fa-users"></i>{% endblock %}

{% block page_title %}
{% if session.get('language', 'ar') == 'ar' %}
    Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
{% else %}
    Customers Management
{% endif %}
{% endblock %}

{% block content %}

<!-- Action Buttons -->
<div class="card mb-4">
    <div class="card-body">
        <button type="button" class="btn btn-success btn-sm" onclick="location.href='/customers/new'" title="Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯">
            <i class="fas fa-plus me-1"></i>
            â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„
        </button>
        <button type="button" class="btn btn-danger btn-sm" onclick="deleteSelectedCustomers()" title="Ø­Ø°Ù Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø­Ø¯Ø¯ÙŠÙ†">
            <i class="fas fa-trash me-1"></i>
            ğŸ—‘ Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯
        </button>
        <button type="button" class="btn btn-secondary btn-sm" onclick="window.print()" title="Ø·Ø¨Ø§Ø¹Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡">
            <i class="fas fa-print me-1"></i>
            ğŸ–¨ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        </button>
        <button type="button" class="btn btn-primary btn-sm" onclick="location.href='/sales'" title="Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª">
            <i class="fas fa-shopping-cart me-1"></i>
            ğŸ’µ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
        </button>
    </div>
</div>

<!-- Search and Filter -->
<div class="row mb-4">
    <div class="col-md-6">
        <div class="input-group">
            <input type="text" class="form-control" id="searchCustomers" placeholder="{% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡...{% else %}Search customers...{% endif %}">
            <button class="btn btn-outline-secondary" type="button">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </div>
    <div class="col-md-3">
        <select class="form-select" id="filterType">
            <option value="">{% if session.get('language', 'ar') == 'ar' %}Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹{% else %}All Types{% endif %}</option>
            <option value="individual">{% if session.get('language', 'ar') == 'ar' %}ÙØ±Ø¯ÙŠ{% else %}Individual{% endif %}</option>
            <option value="corporate">{% if session.get('language', 'ar') == 'ar' %}Ø´Ø±ÙƒØ©{% else %}Corporate{% endif %}</option>
        </select>
    </div>
    <div class="col-md-3">
        <select class="form-select" id="filterStatus">
            <option value="">{% if session.get('language', 'ar') == 'ar' %}Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª{% else %}All Status{% endif %}</option>
            <option value="active">{% if session.get('language', 'ar') == 'ar' %}Ù†Ø´Ø·{% else %}Active{% endif %}</option>
            <option value="inactive">{% if session.get('language', 'ar') == 'ar' %}ØºÙŠØ± Ù†Ø´Ø·{% else %}Inactive{% endif %}</option>
        </select>
    </div>
</div>

<!-- Additional Controls -->
<div class="row mb-3">
    <div class="col-md-4">
        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="selectAll" onchange="toggleSelectAll()">
            <label class="form-check-label" for="selectAll">
                {% if session.get('language', 'ar') == 'ar' %}ØªØ­Ø¯ÙŠØ¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡{% else %}Select All Customers{% endif %}
            </label>
        </div>
    </div>
    <div class="col-md-4 text-center">
        <div class="btn-group" role="group">
            <button type="button" class="btn btn-outline-secondary" onclick="toggleView('table')" id="tableViewBtn">
                <i class="fas fa-table"></i>
                {% if session.get('language', 'ar') == 'ar' %}Ø¬Ø¯ÙˆÙ„{% else %}Table{% endif %}
            </button>
            <button type="button" class="btn btn-outline-secondary active" onclick="toggleView('cards')" id="cardsViewBtn">
                <i class="fas fa-th"></i>
                {% if session.get('language', 'ar') == 'ar' %}ÙƒØ±ÙˆØª{% else %}Cards{% endif %}
            </button>
        </div>
    </div>
    <div class="col-md-4 text-end">
        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="clearFilters()">
            <i class="fas fa-times me-1"></i>
            {% if session.get('language', 'ar') == 'ar' %}Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±{% else %}Clear Filters{% endif %}
        </button>
        <span class="ms-2 text-muted" id="selectedCount">
            {% if session.get('language', 'ar') == 'ar' %}Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ Ø¹Ù…ÙŠÙ„{% else %}No customers selected{% endif %}
        </span>
    </div>
</div>

<!-- Customers Table View -->
<div class="card d-none" id="tableView">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover" id="customersTable">
                <thead>
                    <tr>
                        <th>
                            <input type="checkbox" class="form-check-input" id="selectAllTable" onchange="toggleSelectAllTable()">
                        </th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø§Ø³Ù…{% else %}Name{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù†ÙˆØ¹{% else %}Type{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù‡Ø§ØªÙ{% else %}Phone{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ{% else %}Email{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}Ø¢Ø®Ø± Ø·Ù„Ø¨ÙŠØ©{% else %}Last Order{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø­Ø§Ù„Ø©{% else %}Status{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª{% else %}Actions{% endif %}</th>
                    </tr>
                </thead>
                <tbody id="customersTableBody">
                    <!-- Sample customers data -->
                    <tr>
                        <td><input type="checkbox" class="form-check-input customer-checkbox" data-id="1"></td>
                        <td>
                            <strong>Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯</strong><br>
                            <small class="text-muted">Ø¹Ù…ÙŠÙ„ Ù…Ù†Ø° 2023</small>
                        </td>
                        <td><span class="badge bg-info">ÙØ±Ø¯ÙŠ</span></td>
                        <td>+966 50 123 4567</td>
                        <td>ahmed@example.com</td>
                        <td>2024-01-15</td>
                        <td><span class="badge bg-success">Ù†Ø´Ø·</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary" onclick="viewCustomer(1)" title="Ø¹Ø±Ø¶">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-warning" onclick="editCustomer(1)" title="ØªØ¹Ø¯ÙŠÙ„">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-outline-success" onclick="newOrder(1)" title="Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                                <button class="btn btn-outline-info" onclick="viewOrders(1)" title="Ø§Ù„Ø·Ù„Ø¨ÙŠØ§Øª">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="form-check-input customer-checkbox" data-id="2"></td>
                        <td>
                            <strong>Ø´Ø±ÙƒØ© Ø§Ù„Ø£ØºØ°ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</strong><br>
                            <small class="text-muted">Ø¹Ù…ÙŠÙ„ Ù…Ù†Ø° 2022</small>
                        </td>
                        <td><span class="badge bg-primary">Ø´Ø±ÙƒØ©</span></td>
                        <td>+966 11 456 7890</td>
                        <td>info@foods.com</td>
                        <td>2024-01-18</td>
                        <td><span class="badge bg-success">Ù†Ø´Ø·</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary" onclick="viewCustomer(2)" title="Ø¹Ø±Ø¶">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-warning" onclick="editCustomer(2)" title="ØªØ¹Ø¯ÙŠÙ„">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-outline-success" onclick="newOrder(2)" title="Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                                <button class="btn btn-outline-info" onclick="viewOrders(2)" title="Ø§Ù„Ø·Ù„Ø¨ÙŠØ§Øª">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="form-check-input customer-checkbox" data-id="3"></td>
                        <td>
                            <strong>ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ</strong><br>
                            <small class="text-muted">Ø¹Ù…ÙŠÙ„ Ù…Ù†Ø° 2024</small>
                        </td>
                        <td><span class="badge bg-info">ÙØ±Ø¯ÙŠ</span></td>
                        <td>+966 55 987 6543</td>
                        <td>fatima@example.com</td>
                        <td>2023-12-20</td>
                        <td><span class="badge bg-warning">ØºÙŠØ± Ù†Ø´Ø·</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary" onclick="viewCustomer(3)" title="Ø¹Ø±Ø¶">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-warning" onclick="editCustomer(3)" title="ØªØ¹Ø¯ÙŠÙ„">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-outline-success" onclick="newOrder(3)" title="Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                                <button class="btn btn-outline-info" onclick="viewOrders(3)" title="Ø§Ù„Ø·Ù„Ø¨ÙŠØ§Øª">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="form-check-input customer-checkbox" data-id="4"></td>
                        <td>
                            <strong>Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</strong><br>
                            <small class="text-muted">Ø¹Ù…ÙŠÙ„ Ù…Ù†Ø° 2023</small>
                        </td>
                        <td><span class="badge bg-info">ÙØ±Ø¯ÙŠ</span></td>
                        <td>+966 56 234 5678</td>
                        <td>mohammed@example.com</td>
                        <td>2024-01-20</td>
                        <td><span class="badge bg-success">Ù†Ø´Ø·</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary" onclick="viewCustomer(4)" title="Ø¹Ø±Ø¶">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-warning" onclick="editCustomer(4)" title="ØªØ¹Ø¯ÙŠÙ„">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-outline-success" onclick="newOrder(4)" title="Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                                <button class="btn btn-outline-info" onclick="viewOrders(4)" title="Ø§Ù„Ø·Ù„Ø¨ÙŠØ§Øª">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="form-check-input customer-checkbox" data-id="5"></td>
                        <td>
                            <strong>Ø´Ø±ÙƒØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©</strong><br>
                            <small class="text-muted">Ø¹Ù…ÙŠÙ„ Ù…Ù†Ø° 2021</small>
                        </td>
                        <td><span class="badge bg-primary">Ø´Ø±ÙƒØ©</span></td>
                        <td>+966 12 345 6789</td>
                        <td>info@tech.com</td>
                        <td>2024-01-22</td>
                        <td><span class="badge bg-success">Ù†Ø´Ø·</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary" onclick="viewCustomer(5)" title="Ø¹Ø±Ø¶">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-warning" onclick="editCustomer(5)" title="ØªØ¹Ø¯ÙŠÙ„">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-outline-success" onclick="newOrder(5)" title="Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                                <button class="btn btn-outline-info" onclick="viewOrders(5)" title="Ø§Ù„Ø·Ù„Ø¨ÙŠØ§Øª">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Customers Cards View -->
<div class="row" id="cardsView">
    <!-- Sample Customer Cards -->
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card customer-card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <input type="checkbox" class="form-check-input customer-checkbox me-2" data-id="1">
                    <h6 class="card-title mb-0">Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯</h6>
                </div>
                <span class="badge bg-success">Ù†Ø´Ø·</span>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù†ÙˆØ¹:{% else %}Type:{% endif %}
                        </small>
                        <span class="badge bg-info">ÙØ±Ø¯ÙŠ</span>
                    </div>
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù‡Ø§ØªÙ:{% else %}Phone:{% endif %}
                        </small>
                        <br>+966 50 123 4567
                    </div>
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:{% else %}Email:{% endif %}
                        </small>
                        <br>ahmed@example.com
                    </div>
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø¢Ø®Ø± Ø·Ù„Ø¨ÙŠØ©:{% else %}Last Order:{% endif %}
                        </small>
                        <br>2024-01-20
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100" role="group">
                    <button type="button" class="btn btn-sm btn-outline-primary" onclick="viewCustomer(1)">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-warning" onclick="editCustomer(1)">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-success" onclick="newOrder(1)">
                        <i class="fas fa-shopping-cart"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-info" onclick="viewOrders(1)">
                        <i class="fas fa-history"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card customer-card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <input type="checkbox" class="form-check-input customer-checkbox me-2" data-id="2">
                    <h6 class="card-title mb-0">Ø´Ø±ÙƒØ© Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©</h6>
                </div>
                <span class="badge bg-success">Ù†Ø´Ø·</span>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù†ÙˆØ¹:{% else %}Type:{% endif %}
                        </small>
                        <span class="badge bg-warning">Ø´Ø±ÙƒØ©</span>
                    </div>
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù‡Ø§ØªÙ:{% else %}Phone:{% endif %}
                        </small>
                        <br>+966 11 456 7890
                    </div>
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:{% else %}Email:{% endif %}
                        </small>
                        <br>info@foods.com
                    </div>
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø¢Ø®Ø± Ø·Ù„Ø¨ÙŠØ©:{% else %}Last Order:{% endif %}
                        </small>
                        <br>2024-01-18
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100" role="group">
                    <button type="button" class="btn btn-sm btn-outline-primary" onclick="viewCustomer(2)">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-warning" onclick="editCustomer(2)">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-success" onclick="newOrder(2)">
                        <i class="fas fa-shopping-cart"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-info" onclick="viewOrders(2)">
                        <i class="fas fa-history"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card customer-card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <input type="checkbox" class="form-check-input customer-checkbox me-2" data-id="3">
                    <h6 class="card-title mb-0">ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ</h6>
                </div>
                <span class="badge bg-warning">ØºÙŠØ± Ù†Ø´Ø·</span>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù†ÙˆØ¹:{% else %}Type:{% endif %}
                        </small>
                        <span class="badge bg-primary">ÙØ±Ø¯ÙŠ</span>
                    </div>
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù‡Ø§ØªÙ:{% else %}Phone:{% endif %}
                        </small>
                        <br>+966 55 987 6543
                    </div>
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:{% else %}Email:{% endif %}
                        </small>
                        <br>fatima@example.com
                    </div>
                    <div class="col-12 mb-2">
                        <small class="text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}Ø¢Ø®Ø± Ø·Ù„Ø¨ÙŠØ©:{% else %}Last Order:{% endif %}
                        </small>
                        <br>2024-01-10
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100" role="group">
                    <button type="button" class="btn btn-sm btn-outline-primary" onclick="viewCustomer(3)">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-warning" onclick="editCustomer(3)">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-success" onclick="newOrder(3)">
                        <i class="fas fa-shopping-cart"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-info" onclick="viewOrders(3)">
                        <i class="fas fa-history"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Customer Modal -->
<div class="modal fade" id="addCustomerModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    {% if session.get('language', 'ar') == 'ar' %}Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯{% else %}Add New Customer{% endif %}
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="customerForm">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„{% else %}Customer Name{% endif %}
                            </label>
                            <input type="text" class="form-control" name="customer_name" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„{% else %}Customer Type{% endif %}
                            </label>
                            <select class="form-select" name="customer_type" required>
                                <option value="">{% if session.get('language', 'ar') == 'ar' %}Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹{% else %}Select Type{% endif %}</option>
                                <option value="individual">{% if session.get('language', 'ar') == 'ar' %}ÙØ±Ø¯ÙŠ{% else %}Individual{% endif %}</option>
                                <option value="corporate">{% if session.get('language', 'ar') == 'ar' %}Ø´Ø±ÙƒØ©{% else %}Corporate{% endif %}</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ{% else %}Phone Number{% endif %}
                            </label>
                            <input type="tel" class="form-control" name="phone" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ{% else %}Email{% endif %}
                            </label>
                            <input type="email" class="form-control" name="email">
                        </div>
                        <div class="col-12 mb-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø¹Ù†ÙˆØ§Ù†{% else %}Address{% endif %}
                            </label>
                            <textarea class="form-control" name="address" rows="3"></textarea>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯{% else %}Date of Birth{% endif %}
                            </label>
                            <input type="date" class="form-control" name="birth_date">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø¬Ù†Ø³{% else %}Gender{% endif %}
                            </label>
                            <select class="form-select" name="gender">
                                <option value="">{% if session.get('language', 'ar') == 'ar' %}Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³{% else %}Select Gender{% endif %}</option>
                                <option value="male">{% if session.get('language', 'ar') == 'ar' %}Ø°ÙƒØ±{% else %}Male{% endif %}</option>
                                <option value="female">{% if session.get('language', 'ar') == 'ar' %}Ø£Ù†Ø«Ù‰{% else %}Female{% endif %}</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}Ø­Ø¯ Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†{% else %}Credit Limit{% endif %}
                            </label>
                            <input type="number" class="form-control" name="credit_limit" step="0.01" min="0">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…{% else %}Discount Rate{% endif %}
                            </label>
                            <input type="number" class="form-control" name="discount_rate" step="0.1" min="0" max="100">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    {% if session.get('language', 'ar') == 'ar' %}Ø¥Ù„ØºØ§Ø¡{% else %}Cancel{% endif %}
                </button>
                <button type="button" class="btn btn-primary" onclick="saveCustomer()">
                    {% if session.get('language', 'ar') == 'ar' %}Ø­ÙØ¸{% else %}Save{% endif %}
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Sample customers data - make it globally available
const customersData = [
    {
        id: 1,
        name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯',
        type: 'ÙØ±Ø¯ÙŠ',
        typeClass: 'info',
        phone: '+966 50 123 4567',
        email: 'ahmed@example.com',
        lastOrder: '2024-01-15',
        status: 'Ù†Ø´Ø·',
        statusClass: 'success',
        joinDate: '2023'
    },
    {
        id: 2,
        name: 'Ø´Ø±ÙƒØ© Ø§Ù„Ø£ØºØ°ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©',
        type: 'Ø´Ø±ÙƒØ©',
        typeClass: 'primary',
        phone: '+966 11 456 7890',
        email: 'info@foods.com',
        lastOrder: '2024-01-18',
        status: 'Ù†Ø´Ø·',
        statusClass: 'success',
        joinDate: '2022'
    },
    {
        id: 3,
        name: 'ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ',
        type: 'ÙØ±Ø¯ÙŠ',
        typeClass: 'info',
        phone: '+966 55 987 6543',
        email: 'fatima@example.com',
        lastOrder: '2023-12-20',
        status: 'ØºÙŠØ± Ù†Ø´Ø·',
        statusClass: 'warning',
        joinDate: '2024'
    },
    {
        id: 4,
        name: 'Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ',
        type: 'ÙØ±Ø¯ÙŠ',
        typeClass: 'info',
        phone: '+966 56 234 5678',
        email: 'mohammed@example.com',
        lastOrder: '2024-01-20',
        status: 'Ù†Ø´Ø·',
        statusClass: 'success',
        joinDate: '2023'
    },
    {
        id: 5,
        name: 'Ø´Ø±ÙƒØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©',
        type: 'Ø´Ø±ÙƒØ©',
        typeClass: 'primary',
        phone: '+966 12 345 6789',
        email: 'info@tech.com',
        lastOrder: '2024-01-22',
        status: 'Ù†Ø´Ø·',
        statusClass: 'success',
        joinDate: '2021'
    }
];

function toggleView(viewType) {
    const tableView = document.getElementById('tableView');
    const cardsView = document.getElementById('cardsView');
    const tableBtn = document.getElementById('tableViewBtn');
    const cardsBtn = document.getElementById('cardsViewBtn');

    if (viewType === 'table') {
        tableView.classList.remove('d-none');
        cardsView.classList.add('d-none');
        tableBtn.classList.add('active');
        cardsBtn.classList.remove('active');

        // Load table data when switching to table view
        loadTableData();
    } else {
        tableView.classList.add('d-none');
        cardsView.classList.remove('d-none');
        tableBtn.classList.remove('active');
        cardsBtn.classList.add('active');
    }
}

function loadTableData() {
    const tbody = document.getElementById('customersTableBody');

    // Clear existing data
    tbody.innerHTML = '';

    // Add data rows
    customersData.forEach(customer => {
        const row = document.createElement('tr');

        row.innerHTML = `
            <td><input type="checkbox" class="form-check-input customer-checkbox" data-id="${customer.id}"></td>
            <td>
                <strong>${customer.name}</strong><br>
                <small class="text-muted">Ø¹Ù…ÙŠÙ„ Ù…Ù†Ø° ${customer.joinDate}</small>
            </td>
            <td><span class="badge bg-${customer.typeClass}">${customer.type}</span></td>
            <td>${customer.phone}</td>
            <td>${customer.email}</td>
            <td>${customer.lastOrder}</td>
            <td><span class="badge bg-${customer.statusClass}">${customer.status}</span></td>
            <td>
                <div class="btn-group btn-group-sm">
                    <button class="btn btn-outline-primary" onclick="viewCustomer(${customer.id})" title="Ø¹Ø±Ø¶">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-outline-warning" onclick="editCustomer(${customer.id})" title="ØªØ¹Ø¯ÙŠÙ„">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn btn-outline-success" onclick="newOrder(${customer.id})" title="Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©">
                        <i class="fas fa-shopping-cart"></i>
                    </button>
                    <button class="btn btn-outline-info" onclick="viewOrders(${customer.id})" title="Ø§Ù„Ø·Ù„Ø¨ÙŠØ§Øª">
                        <i class="fas fa-history"></i>
                    </button>
                </div>
            </td>
        `;

        tbody.appendChild(row);
    });

    // Re-attach event listeners for checkboxes
    attachCheckboxListeners();
}

function attachCheckboxListeners() {
    document.querySelectorAll('.customer-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', updateSelectedCount);
    });
}

function toggleSelectAllTable() {
    const selectAllTable = document.getElementById('selectAllTable');
    const checkboxes = document.querySelectorAll('#customersTable .customer-checkbox');

    checkboxes.forEach(checkbox => {
        checkbox.checked = selectAllTable.checked;
    });

    updateSelectedCount();
}

// Initialize page when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ”„ Initializing customers page...');

    // Setup search functionality
    setupSearchAndFilter();

    // Load initial cards data
    updateCardsWithData(customersData);

    // Add event listeners to customer checkboxes
    attachCheckboxListeners();

    // Initialize selected count
    updateSelectedCount();

    console.log('âœ… Customers page initialized successfully');
});

// Search and filter functionality
function setupSearchAndFilter() {
    const searchInput = document.getElementById('searchCustomers');
    const typeFilter = document.getElementById('filterType');
    const statusFilter = document.getElementById('filterStatus');

    if (searchInput) searchInput.addEventListener('input', filterAndSearch);
    if (typeFilter) typeFilter.addEventListener('change', filterAndSearch);
    if (statusFilter) statusFilter.addEventListener('change', filterAndSearch);
}

function filterAndSearch() {
    const searchTerm = document.getElementById('searchCustomers').value.toLowerCase();
    const selectedType = document.getElementById('filterType').value;
    const selectedStatus = document.getElementById('filterStatus').value;

    let filteredData = customersData.filter(customer => {
        const matchesSearch = customer.name.toLowerCase().includes(searchTerm) ||
                            customer.phone.includes(searchTerm) ||
                            customer.email.toLowerCase().includes(searchTerm);
        const matchesType = !selectedType || customer.type === selectedType;
        const matchesStatus = !selectedStatus || customer.status === selectedStatus;

        return matchesSearch && matchesType && matchesStatus;
    });

    // Update table if in table view
    if (!document.getElementById('tableView').classList.contains('d-none')) {
        updateTableWithData(filteredData);
    }

    // Update cards view
    updateCardsWithData(filteredData);
}

function updateTableWithData(data) {
    const tbody = document.getElementById('customersTableBody');
    tbody.innerHTML = '';

    data.forEach(customer => {
        const row = document.createElement('tr');

        row.innerHTML = `
            <td><input type="checkbox" class="form-check-input customer-checkbox" data-id="${customer.id}"></td>
            <td>
                <strong>${customer.name}</strong><br>
                <small class="text-muted">Ø¹Ù…ÙŠÙ„ Ù…Ù†Ø° ${customer.joinDate}</small>
            </td>
            <td><span class="badge bg-${customer.typeClass}">${customer.type}</span></td>
            <td>${customer.phone}</td>
            <td>${customer.email}</td>
            <td>${customer.lastOrder}</td>
            <td><span class="badge bg-${customer.statusClass}">${customer.status}</span></td>
            <td>
                <div class="btn-group btn-group-sm">
                    <button class="btn btn-outline-primary" onclick="viewCustomer(${customer.id})" title="Ø¹Ø±Ø¶">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-outline-warning" onclick="editCustomer(${customer.id})" title="ØªØ¹Ø¯ÙŠÙ„">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn btn-outline-success" onclick="newOrder(${customer.id})" title="Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©">
                        <i class="fas fa-shopping-cart"></i>
                    </button>
                    <button class="btn btn-outline-info" onclick="viewOrders(${customer.id})" title="Ø§Ù„Ø·Ù„Ø¨ÙŠØ§Øª">
                        <i class="fas fa-history"></i>
                    </button>
                </div>
            </td>
        `;
        tbody.appendChild(row);
    });

    // Re-attach event listeners
    attachCheckboxListeners();
}

function updateCardsWithData(data) {
    const cardsContainer = document.getElementById('cardsView');
    cardsContainer.innerHTML = '';

    data.forEach(customer => {
        const cardCol = document.createElement('div');
        cardCol.className = 'col-md-6 col-lg-4 mb-4';

        cardCol.innerHTML = `
            <div class="card customer-card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <div class="d-flex align-items-center">
                        <input type="checkbox" class="form-check-input customer-checkbox me-2" data-id="${customer.id}">
                        <h6 class="card-title mb-0">${customer.name}</h6>
                    </div>
                    <span class="badge bg-${customer.statusClass}">${customer.status}</span>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-12 mb-2">
                            <small class="text-muted">
                                {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù†ÙˆØ¹:{% else %}Type:{% endif %}
                            </small>
                            <span class="badge bg-${customer.typeClass}">${customer.type}</span>
                        </div>
                        <div class="col-12 mb-2">
                            <small class="text-muted">
                                {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ù‡Ø§ØªÙ:{% else %}Phone:{% endif %}
                            </small>
                            <br>${customer.phone}
                        </div>
                        <div class="col-12 mb-2">
                            <small class="text-muted">
                                {% if session.get('language', 'ar') == 'ar' %}Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:{% else %}Email:{% endif %}
                            </small>
                            <br>${customer.email}
                        </div>
                        <div class="col-12 mb-2">
                            <small class="text-muted">
                                {% if session.get('language', 'ar') == 'ar' %}Ø¢Ø®Ø± Ø·Ù„Ø¨ÙŠØ©:{% else %}Last Order:{% endif %}
                            </small>
                            <br>${customer.lastOrder}
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <div class="btn-group w-100" role="group">
                        <button type="button" class="btn btn-sm btn-outline-primary" onclick="viewCustomer(${customer.id})">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button type="button" class="btn btn-sm btn-outline-warning" onclick="editCustomer(${customer.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button type="button" class="btn btn-sm btn-outline-success" onclick="newOrder(${customer.id})">
                            <i class="fas fa-shopping-cart"></i>
                        </button>
                        <button type="button" class="btn btn-sm btn-outline-info" onclick="viewOrders(${customer.id})">
                            <i class="fas fa-history"></i>
                        </button>
                    </div>
                </div>
            </div>
        `;

        cardsContainer.appendChild(cardCol);
    });

    // Re-attach event listeners for checkboxes
    attachCheckboxListeners();

    console.log('Cards view updated with', data.length, 'customers');
}

function loadCustomers() {
    // This would normally load from server
    console.log('Loading customers...');
}

function viewCustomer(id) {
    const customer = customersData.find(c => c.id === id);
    if (customer) {
        const message = `Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customer.name}\nØ§Ù„Ù†ÙˆØ¹: ${customer.type}\nØ§Ù„Ù‡Ø§ØªÙ: ${customer.phone}\nØ§Ù„Ø¨Ø±ÙŠØ¯: ${customer.email}\nØ¢Ø®Ø± Ø·Ù„Ø¨ÙŠØ©: ${customer.lastOrder}`;
        alert(message);
    } else {
        showToast(isRTL ? `Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø±Ù‚Ù…: ${id}` : `Viewing customer: ${id}`, 'info');
    }
}

function editCustomer(id) {
    const customer = customersData.find(c => c.id === id);
    if (customer) {
        alert(`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customer.name}\nØ§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${customer.status}`);
    }

    // Show modal for editing
    const modal = new bootstrap.Modal(document.getElementById('addCustomerModal'));
    modal.show();
    showToast(isRTL ? `ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø±Ù‚Ù…: ${id}` : `Editing customer: ${id}`, 'info');
}

function deleteCustomer(id) {
    const message = isRTL ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŸ' : 'Are you sure you want to delete this customer?';

    confirmAction(message, function() {
        const deleteBtn = event.target.closest('button');
        showLoading(deleteBtn);

        // Simulate API call
        setTimeout(() => {
            hideLoading(deleteBtn);
            showToast(isRTL ? 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­' : 'Customer deleted successfully', 'success');
            // Remove row from table
            deleteBtn.closest('tr').remove();
        }, 1000);
    });
}

function newOrder(id) {
    // Redirect to sales page with customer pre-selected
    window.location.href = `/sales?customer_id=${id}`;
}

function viewOrders(id) {
    // Redirect to sales page filtered by customer
    window.location.href = `/sales?customer_id=${id}`;
}

function saveCustomer() {
    const form = document.getElementById('customerForm');

    if (!validateForm(form)) {
        showToast(isRTL ? 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©' : 'Please fill all required fields', 'warning');
        return;
    }

    const saveBtn = document.querySelector('#addCustomerModal .btn-primary');
    showLoading(saveBtn);

    // Simulate API call
    setTimeout(() => {
        hideLoading(saveBtn);
        showToast(isRTL ? 'ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­' : 'Customer saved successfully', 'success');

        // Close modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('addCustomerModal'));
        modal.hide();

        // Reload customers
        loadCustomers();
    }, 1000);
}

// Refresh data
function refreshData() {
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>' + (isRTL ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...' : 'Refreshing...');

    setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = originalText;
        showToast(isRTL ? 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­' : 'Data refreshed successfully', 'success');
        loadCustomers();
    }, 1500);
}

// Generate report
function generateReport() {
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>' + (isRTL ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡...' : 'Generating...');

    setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = originalText;
        showToast(isRTL ? 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­' : 'Customers report generated successfully', 'success');
    }, 1500);
}

// Export customers
function exportCustomers() {
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>' + (isRTL ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±...' : 'Exporting...');

    setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = originalText;
        showToast(isRTL ? 'ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­' : 'Data exported successfully', 'success');
    }, 1500);
}

// Save all data
function saveAllData() {
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>' + (isRTL ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...' : 'Saving...');

    setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = originalText;
        showToast(isRTL ? 'ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­' : 'All data saved successfully', 'success');
    }, 1500);
}

// Print report
function printReport() {
    showToast(isRTL ? 'Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©...' : 'Preparing report for printing...', 'info');
    setTimeout(() => {
        window.print();
    }, 1000);
}

// Toggle select all
function toggleSelectAll() {
    const selectAll = document.getElementById('selectAll');
    const checkboxes = document.querySelectorAll('.customer-checkbox');

    checkboxes.forEach(checkbox => {
        checkbox.checked = selectAll.checked;
    });

    updateSelectedCount();
}

// Update selected count
function updateSelectedCount() {
    const selected = document.querySelectorAll('.customer-checkbox:checked');
    const countElement = document.getElementById('selectedCount');

    if (selected.length === 0) {
        countElement.textContent = isRTL ? 'Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ Ø¹Ù…ÙŠÙ„' : 'No customers selected';
        countElement.className = 'ms-2 text-muted';
    } else {
        countElement.textContent = isRTL ? `ØªÙ… ØªØ­Ø¯ÙŠØ¯ ${selected.length} Ø¹Ù…ÙŠÙ„` : `${selected.length} customers selected`;
        countElement.className = 'ms-2 text-primary fw-bold';
    }
}

// Clear filters
function clearFilters() {
    document.getElementById('searchCustomers').value = '';
    document.getElementById('filterType').value = '';
    document.getElementById('filterStatus').value = '';
    document.getElementById('selectAll').checked = false;

    // Clear all checkboxes
    document.querySelectorAll('.customer-checkbox').forEach(checkbox => {
        checkbox.checked = false;
    });

    updateSelectedCount();
    showToast(isRTL ? 'ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ„Ø§ØªØ±' : 'All filters cleared', 'info');
}

// Delete selected
function deleteSelected() {
    const selected = document.querySelectorAll('.customer-checkbox:checked');
    if (selected.length === 0) {
        showToast(isRTL ? 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„' : 'Please select at least one customer', 'warning');
        return;
    }

    if (confirm(isRTL ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø­Ø¯Ø¯ÙŠÙ†ØŸ' : 'Are you sure you want to delete selected customers?')) {
        showToast(isRTL ? 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø­Ø¯Ø¯ÙŠÙ†' : 'Selected customers deleted', 'success');

        // Clear selections
        document.getElementById('selectAll').checked = false;
        document.querySelectorAll('.customer-checkbox').forEach(checkbox => {
            checkbox.checked = false;
        });
        updateSelectedCount();

        loadCustomers();
    }
}

// Reset modal when closed
document.getElementById('addCustomerModal')?.addEventListener('hidden.bs.modal', function () {
    const form = document.getElementById('customerForm');
    form.reset();
    clearFormValidation(form);
});

// Delete selected customers
function deleteSelectedCustomers() {
    const selected = document.querySelectorAll('.customer-checkbox:checked');
    if (selected.length === 0) {
        alert('ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø¹Ù…ÙŠÙ„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø­Ø°Ù');
        return;
    }

    if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ${selected.length} Ø¹Ù…ÙŠÙ„ØŸ`)) {
        alert(`ØªÙ… Ø­Ø°Ù ${selected.length} Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­`);
        location.reload();
    }
}
</script>
{% endblock %}
