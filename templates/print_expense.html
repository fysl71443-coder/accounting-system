<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>طباعة مصروف - {{ expense.expense_number }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @media print {
            .no-print { display: none !important; }
            body { margin: 0; }
            .container { max-width: 100% !important; }
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        
        .print-container {
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            margin: 20px auto;
            max-width: 800px;
        }
        
        .header-section {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .company-logo {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #007bff;
        }
        
        .expense-details {
            padding: 30px;
        }
        
        .detail-row {
            border-bottom: 1px solid #eee;
            padding: 15px 0;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .label {
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
        }
        
        .value {
            font-size: 1.1rem;
            color: #212529;
        }
        
        .amount-highlight {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }
        
        .amount-value {
            font-size: 2rem;
            font-weight: bold;
            color: #1976d2;
        }
        
        .footer-section {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            border-top: 3px solid #007bff;
        }
        
        .print-info {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .status-unpaid {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .status-paid {
            background: #d1edff;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="print-container">
        <!-- Header Section -->
        <div class="header-section">
            <div class="company-logo">
                <i class="fas fa-building"></i>
            </div>
            <h1 class="mb-2">{{ company.name }}</h1>
            <p class="mb-1">{{ company.name_en }}</p>
            <p class="mb-0">{{ company.address }}</p>
            <div class="mt-3">
                <small>
                    <i class="fas fa-phone me-2"></i>{{ company.phone }}
                    <span class="mx-3">|</span>
                    <i class="fas fa-envelope me-2"></i>{{ company.email }}
                </small>
            </div>
        </div>

        <!-- Expense Details -->
        <div class="expense-details">
            <div class="row mb-4">
                <div class="col-md-6">
                    <h2 class="text-primary">
                        <i class="fas fa-receipt me-2"></i>سند مصروف
                    </h2>
                </div>
                <div class="col-md-6 text-end">
                    <h3 class="text-muted">{{ expense.expense_number }}</h3>
                    <p class="mb-0">
                        <small class="text-muted">تاريخ الطباعة: {{ print_date.strftime('%Y-%m-%d %H:%M') }}</small>
                    </p>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="detail-row">
                        <div class="label">تاريخ المصروف</div>
                        <div class="value">
                            <i class="fas fa-calendar me-2 text-primary"></i>
                            {{ expense.date.strftime('%Y-%m-%d') if expense.date else '-' }}
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="detail-row">
                        <div class="label">نوع المصروف</div>
                        <div class="value">
                            <i class="fas fa-tag me-2 text-primary"></i>
                            {{ expense.expense_type or expense.category or 'عام' }}
                        </div>
                    </div>
                </div>
            </div>

            <div class="detail-row">
                <div class="label">وصف المصروف</div>
                <div class="value">
                    <i class="fas fa-file-text me-2 text-primary"></i>
                    {{ expense.description }}
                </div>
            </div>

            {% if expense.vendor %}
            <div class="detail-row">
                <div class="label">المورد</div>
                <div class="value">
                    <i class="fas fa-user-tie me-2 text-primary"></i>
                    {{ expense.vendor }}
                </div>
            </div>
            {% endif %}

            {% if expense.reference %}
            <div class="detail-row">
                <div class="label">رقم المرجع</div>
                <div class="value">
                    <i class="fas fa-hashtag me-2 text-primary"></i>
                    {{ expense.reference }}
                </div>
            </div>
            {% endif %}

            <div class="row">
                <div class="col-md-6">
                    <div class="detail-row">
                        <div class="label">طريقة الدفع</div>
                        <div class="value">
                            <i class="fas fa-credit-card me-2 text-primary"></i>
                            {% if expense.payment_method == 'cash' %}نقدي
                            {% elif expense.payment_method == 'bank' %}بنكي
                            {% elif expense.payment_method == 'card' %}بطاقة ائتمان
                            {% else %}{{ expense.payment_method or 'غير محدد' }}
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="detail-row">
                        <div class="label">حالة الدفع</div>
                        <div class="value">
                            {% if expense.payment_status == 'paid' %}
                                <span class="status-badge status-paid">مدفوع</span>
                            {% else %}
                                <span class="status-badge status-unpaid">غير مدفوع</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Amount Highlight -->
            <div class="amount-highlight">
                <div class="label mb-2">المبلغ الإجمالي</div>
                <div class="amount-value">{{ "%.2f"|format(expense.amount) }} ريال سعودي</div>
                {% if expense.paid_amount and expense.paid_amount > 0 %}
                <div class="mt-2">
                    <small class="text-muted">المبلغ المدفوع: {{ "%.2f"|format(expense.paid_amount) }} ريال</small>
                </div>
                {% endif %}
            </div>

            {% if expense.notes %}
            <div class="detail-row">
                <div class="label">ملاحظات</div>
                <div class="value">
                    <i class="fas fa-sticky-note me-2 text-primary"></i>
                    {{ expense.notes }}
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Footer Section -->
        <div class="footer-section">
            <div class="row">
                <div class="col-md-6">
                    <p class="print-info mb-1">
                        <strong>الرقم الضريبي:</strong> {{ company.tax_number }}
                    </p>
                </div>
                <div class="col-md-6">
                    <p class="print-info mb-1">
                        <strong>تم الطباعة بواسطة:</strong> نظام المحاسبة المتكامل
                    </p>
                </div>
            </div>
            <hr>
            <p class="print-info mb-0">
                <i class="fas fa-info-circle me-1"></i>
                هذا المستند تم إنشاؤه إلكترونياً ولا يحتاج إلى توقيع
            </p>
        </div>
    </div>

    <!-- Print Button -->
    <div class="text-center my-4 no-print">
        <button class="btn btn-primary btn-lg me-3" onclick="window.print()">
            <i class="fas fa-print me-2"></i>طباعة
        </button>
        <button class="btn btn-secondary btn-lg" onclick="window.close()">
            <i class="fas fa-times me-2"></i>إغلاق
        </button>
    </div>

    <script>
        // Auto print when page loads
        window.onload = function() {
            // Optional: Auto print
            // window.print();
        }
    </script>
</body>
</html>
