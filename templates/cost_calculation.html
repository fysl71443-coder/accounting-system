{% extends "base_unified.html" %}

{% block title %}
{% if session.get('language', 'ar') == 'ar' %}
حساب التكلفة - نظام المحاسبة
{% else %}
Cost Calculation - Accounting System
{% endif %}
{% endblock %}

{% block page_icon %}<i class="fas fa-calculator"></i>{% endblock %}

{% block page_title %}
{% if session.get('language', 'ar') == 'ar' %}حساب التكلفة{% else %}Cost Calculation{% endif %}
{% endblock %}

{% block page_actions %}
<div class="btn-group">
    <button type="button" class="btn btn-primary" onclick="refreshData()">
        <i class="fas fa-sync-alt me-1"></i>
        {% if session.get('language', 'ar') == 'ar' %}تحديث البيانات{% else %}Refresh Data{% endif %}
    </button>
    <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#costCalculationModal">
        <i class="fas fa-plus me-1"></i>
        {% if session.get('language', 'ar') == 'ar' %}حساب تكلفة جديدة{% else %}New Cost Calculation{% endif %}
    </button>
    <button type="button" class="btn btn-info" onclick="generateReport()">
        <i class="fas fa-file-alt me-1"></i>
        {% if session.get('language', 'ar') == 'ar' %}تقرير التكاليف{% else %}Cost Report{% endif %}
    </button>
    <button type="button" class="btn btn-secondary" onclick="exportData()">
        <i class="fas fa-download me-1"></i>
        {% if session.get('language', 'ar') == 'ar' %}تصدير{% else %}Export{% endif %}
    </button>
    <button type="button" class="btn btn-warning" onclick="saveAllData()">
        <i class="fas fa-save me-1"></i>
        {% if session.get('language', 'ar') == 'ar' %}حفظ البيانات{% else %}Save Data{% endif %}
    </button>
    <button type="button" class="btn btn-dark" onclick="printReport()">
        <i class="fas fa-print me-1"></i>
        {% if session.get('language', 'ar') == 'ar' %}طباعة{% else %}Print{% endif %}
    </button>
</div>
{% endblock %}

{% block content %}
<!-- Summary Cards -->
<div class="row g-3 mb-4">
    <div class="col-xl-3 col-md-6">
        <div class="card h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-uppercase mb-1 text-muted small">
                            {% if session.get('language', 'ar') == 'ar' %}إجمالي التكاليف{% else %}Total Costs{% endif %}
                        </h6>
                        <h4 class="mb-0 text-primary" id="total-costs">0.00 ريال</h4>
                    </div>
                    <div class="text-primary opacity-75">
                        <i class="fas fa-calculator fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6">
        <div class="card h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-uppercase mb-1 text-muted small">
                            {% if session.get('language', 'ar') == 'ar' %}تكلفة المواد{% else %}Material Costs{% endif %}
                        </h6>
                        <h4 class="mb-0 text-success" id="material-costs">0.00 ريال</h4>
                    </div>
                    <div class="text-success opacity-75">
                        <i class="fas fa-boxes fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6">
        <div class="card h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-uppercase mb-1 text-muted small">
                            {% if session.get('language', 'ar') == 'ar' %}تكلفة العمالة{% else %}Labor Costs{% endif %}
                        </h6>
                        <h4 class="mb-0 text-warning" id="labor-costs">0.00 ريال</h4>
                    </div>
                    <div class="text-warning opacity-75">
                        <i class="fas fa-users fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6">
        <div class="card h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-uppercase mb-1 text-muted small">
                            {% if session.get('language', 'ar') == 'ar' %}التكاليف الإضافية{% else %}Overhead Costs{% endif %}
                        </h6>
                        <h4 class="mb-0 text-danger" id="overhead-costs">0.00 ريال</h4>
                    </div>
                    <div class="text-danger opacity-75">
                        <i class="fas fa-cogs fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Cost Calculation Form -->
<div class="card mb-4">
    <div class="card-header">
        <h6 class="mb-0">
            <i class="fas fa-calculator me-2"></i>
            {% if session.get('language', 'ar') == 'ar' %}حاسبة التكلفة السريعة{% else %}Quick Cost Calculator{% endif %}
        </h6>
    </div>
    <div class="card-body">
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label">
                    {% if session.get('language', 'ar') == 'ar' %}اسم المنتج/المشروع{% else %}Product/Project Name{% endif %}
                </label>
                <input type="text" class="form-control" id="quick-product-name" placeholder="{% if session.get('language', 'ar') == 'ar' %}أدخل اسم المنتج{% else %}Enter product name{% endif %}">
            </div>
            <div class="col-md-3">
                <label class="form-label">
                    {% if session.get('language', 'ar') == 'ar' %}الكمية{% else %}Quantity{% endif %}
                </label>
                <input type="number" class="form-control" id="quick-quantity" min="1" value="1" onchange="calculateQuickCost()">
            </div>
            <div class="col-md-3">
                <label class="form-label">
                    {% if session.get('language', 'ar') == 'ar' %}الوحدة{% else %}Unit{% endif %}
                </label>
                <select class="form-select" id="quick-unit">
                    <option value="piece">{% if session.get('language', 'ar') == 'ar' %}قطعة{% else %}Piece{% endif %}</option>
                    <option value="kg">{% if session.get('language', 'ar') == 'ar' %}كيلوجرام{% else %}Kilogram{% endif %}</option>
                    <option value="meter">{% if session.get('language', 'ar') == 'ar' %}متر{% else %}Meter{% endif %}</option>
                    <option value="liter">{% if session.get('language', 'ar') == 'ar' %}لتر{% else %}Liter{% endif %}</option>
                </select>
            </div>
        </div>
        
        <div class="row g-3 mt-2">
            <div class="col-md-3">
                <label class="form-label">
                    {% if session.get('language', 'ar') == 'ar' %}تكلفة المواد{% else %}Material Cost{% endif %}
                </label>
                <input type="number" class="form-control" id="quick-material-cost" step="0.01" min="0" onchange="calculateQuickCost()">
            </div>
            <div class="col-md-3">
                <label class="form-label">
                    {% if session.get('language', 'ar') == 'ar' %}تكلفة العمالة{% else %}Labor Cost{% endif %}
                </label>
                <input type="number" class="form-control" id="quick-labor-cost" step="0.01" min="0" onchange="calculateQuickCost()">
            </div>
            <div class="col-md-3">
                <label class="form-label">
                    {% if session.get('language', 'ar') == 'ar' %}التكاليف الإضافية{% else %}Overhead Cost{% endif %}
                </label>
                <input type="number" class="form-control" id="quick-overhead-cost" step="0.01" min="0" onchange="calculateQuickCost()">
            </div>
            <div class="col-md-3">
                <label class="form-label">
                    {% if session.get('language', 'ar') == 'ar' %}هامش الربح (%){% else %}Profit Margin (%){% endif %}
                </label>
                <input type="number" class="form-control" id="quick-profit-margin" step="0.01" min="0" max="100" value="20" onchange="calculateQuickCost()">
            </div>
        </div>
        
        <div class="row g-3 mt-3">
            <div class="col-md-12">
                <div class="card bg-light">
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-md-3">
                                <h6 class="text-muted">{% if session.get('language', 'ar') == 'ar' %}إجمالي التكلفة{% else %}Total Cost{% endif %}</h6>
                                <h4 class="text-primary" id="quick-total-cost">0.00 ريال</h4>
                            </div>
                            <div class="col-md-3">
                                <h6 class="text-muted">{% if session.get('language', 'ar') == 'ar' %}تكلفة الوحدة{% else %}Unit Cost{% endif %}</h6>
                                <h4 class="text-success" id="quick-unit-cost">0.00 ريال</h4>
                            </div>
                            <div class="col-md-3">
                                <h6 class="text-muted">{% if session.get('language', 'ar') == 'ar' %}سعر البيع المقترح{% else %}Suggested Selling Price{% endif %}</h6>
                                <h4 class="text-warning" id="quick-selling-price">0.00 ريال</h4>
                            </div>
                            <div class="col-md-3">
                                <h6 class="text-muted">{% if session.get('language', 'ar') == 'ar' %}إجمالي الربح{% else %}Total Profit{% endif %}</h6>
                                <h4 class="text-info" id="quick-total-profit">0.00 ريال</h4>
                            </div>
                        </div>
                        <div class="text-center mt-3">
                            <button type="button" class="btn btn-success" onclick="saveQuickCalculation()">
                                <i class="fas fa-save me-1"></i>
                                {% if session.get('language', 'ar') == 'ar' %}حفظ الحساب{% else %}Save Calculation{% endif %}
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearQuickCalculation()">
                                <i class="fas fa-eraser me-1"></i>
                                {% if session.get('language', 'ar') == 'ar' %}مسح{% else %}Clear{% endif %}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Saved Calculations -->
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h6 class="mb-0">
            <i class="fas fa-history me-2"></i>
            {% if session.get('language', 'ar') == 'ar' %}الحسابات المحفوظة{% else %}Saved Calculations{% endif %}
        </h6>
        <button type="button" class="btn btn-outline-primary btn-sm" onclick="loadCalculations()">
            <i class="fas fa-refresh me-1"></i>
            {% if session.get('language', 'ar') == 'ar' %}تحديث{% else %}Refresh{% endif %}
        </button>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead>
                    <tr>
                        <th>{% if session.get('language', 'ar') == 'ar' %}اسم المنتج{% else %}Product Name{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}الكمية{% else %}Quantity{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}تكلفة المواد{% else %}Material Cost{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}تكلفة العمالة{% else %}Labor Cost{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}التكاليف الإضافية{% else %}Overhead{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}إجمالي التكلفة{% else %}Total Cost{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}سعر البيع{% else %}Selling Price{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}الربح{% else %}Profit{% endif %}</th>
                        <th>{% if session.get('language', 'ar') == 'ar' %}الإجراءات{% else %}Actions{% endif %}</th>
                    </tr>
                </thead>
                <tbody id="calculations-tbody">
                    <tr>
                        <td colspan="9" class="text-center text-muted">
                            {% if session.get('language', 'ar') == 'ar' %}لا توجد حسابات محفوظة{% else %}No saved calculations{% endif %}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Cost Calculation Modal -->
<div class="modal fade" id="costCalculationModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    {% if session.get('language', 'ar') == 'ar' %}حساب تكلفة مفصل{% else %}Detailed Cost Calculation{% endif %}
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="costCalculationForm">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}اسم المنتج/المشروع{% else %}Product/Project Name{% endif %} *
                            </label>
                            <input type="text" class="form-control" id="productName" required>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}الكمية{% else %}Quantity{% endif %} *
                            </label>
                            <input type="number" class="form-control" id="quantity" min="1" value="1" required>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">
                                {% if session.get('language', 'ar') == 'ar' %}الوحدة{% else %}Unit{% endif %}
                            </label>
                            <select class="form-select" id="unit">
                                <option value="piece">{% if session.get('language', 'ar') == 'ar' %}قطعة{% else %}Piece{% endif %}</option>
                                <option value="kg">{% if session.get('language', 'ar') == 'ar' %}كيلوجرام{% else %}Kilogram{% endif %}</option>
                                <option value="meter">{% if session.get('language', 'ar') == 'ar' %}متر{% else %}Meter{% endif %}</option>
                                <option value="liter">{% if session.get('language', 'ar') == 'ar' %}لتر{% else %}Liter{% endif %}</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Material Costs Section -->
                    <div class="mt-4">
                        <h6 class="border-bottom pb-2">
                            <i class="fas fa-boxes me-2"></i>
                            {% if session.get('language', 'ar') == 'ar' %}تكاليف المواد{% else %}Material Costs{% endif %}
                        </h6>
                        <div id="material-costs-section">
                            <div class="row g-3 material-cost-row">
                                <div class="col-md-4">
                                    <input type="text" class="form-control" placeholder="{% if session.get('language', 'ar') == 'ar' %}اسم المادة{% else %}Material Name{% endif %}">
                                </div>
                                <div class="col-md-2">
                                    <input type="number" class="form-control" placeholder="{% if session.get('language', 'ar') == 'ar' %}الكمية{% else %}Quantity{% endif %}" step="0.01">
                                </div>
                                <div class="col-md-2">
                                    <input type="number" class="form-control" placeholder="{% if session.get('language', 'ar') == 'ar' %}سعر الوحدة{% else %}Unit Price{% endif %}" step="0.01">
                                </div>
                                <div class="col-md-2">
                                    <input type="number" class="form-control" placeholder="{% if session.get('language', 'ar') == 'ar' %}الإجمالي{% else %}Total{% endif %}" readonly>
                                </div>
                                <div class="col-md-2">
                                    <button type="button" class="btn btn-outline-danger btn-sm" onclick="removeMaterialRow(this)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-outline-primary btn-sm mt-2" onclick="addMaterialRow()">
                            <i class="fas fa-plus me-1"></i>
                            {% if session.get('language', 'ar') == 'ar' %}إضافة مادة{% else %}Add Material{% endif %}
                        </button>
                    </div>
                    
                    <!-- Labor Costs Section -->
                    <div class="mt-4">
                        <h6 class="border-bottom pb-2">
                            <i class="fas fa-users me-2"></i>
                            {% if session.get('language', 'ar') == 'ar' %}تكاليف العمالة{% else %}Labor Costs{% endif %}
                        </h6>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label class="form-label">{% if session.get('language', 'ar') == 'ar' %}عدد الساعات{% else %}Hours{% endif %}</label>
                                <input type="number" class="form-control" id="laborHours" step="0.5" min="0">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">{% if session.get('language', 'ar') == 'ar' %}تكلفة الساعة{% else %}Cost per Hour{% endif %}</label>
                                <input type="number" class="form-control" id="laborRate" step="0.01" min="0">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">{% if session.get('language', 'ar') == 'ar' %}إجمالي تكلفة العمالة{% else %}Total Labor Cost{% endif %}</label>
                                <input type="number" class="form-control" id="totalLaborCost" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Overhead Costs Section -->
                    <div class="mt-4">
                        <h6 class="border-bottom pb-2">
                            <i class="fas fa-cogs me-2"></i>
                            {% if session.get('language', 'ar') == 'ar' %}التكاليف الإضافية{% else %}Overhead Costs{% endif %}
                        </h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">{% if session.get('language', 'ar') == 'ar' %}التكاليف الثابتة{% else %}Fixed Costs{% endif %}</label>
                                <input type="number" class="form-control" id="fixedCosts" step="0.01" min="0">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">{% if session.get('language', 'ar') == 'ar' %}التكاليف المتغيرة{% else %}Variable Costs{% endif %}</label>
                                <input type="number" class="form-control" id="variableCosts" step="0.01" min="0">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Profit Margin -->
                    <div class="mt-4">
                        <h6 class="border-bottom pb-2">
                            <i class="fas fa-chart-line me-2"></i>
                            {% if session.get('language', 'ar') == 'ar' %}هامش الربح{% else %}Profit Margin{% endif %}
                        </h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">{% if session.get('language', 'ar') == 'ar' %}هامش الربح (%){% else %}Profit Margin (%){% endif %}</label>
                                <input type="number" class="form-control" id="profitMargin" step="0.01" min="0" max="100" value="20">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">{% if session.get('language', 'ar') == 'ar' %}مبلغ الربح{% else %}Profit Amount{% endif %}</label>
                                <input type="number" class="form-control" id="profitAmount" readonly>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    {% if session.get('language', 'ar') == 'ar' %}إلغاء{% else %}Cancel{% endif %}
                </button>
                <button type="button" class="btn btn-info" onclick="calculateDetailedCost()">
                    <i class="fas fa-calculator me-1"></i>
                    {% if session.get('language', 'ar') == 'ar' %}حساب التكلفة{% else %}Calculate Cost{% endif %}
                </button>
                <button type="button" class="btn btn-success" onclick="saveDetailedCalculation()">
                    <i class="fas fa-save me-1"></i>
                    {% if session.get('language', 'ar') == 'ar' %}حفظ الحساب{% else %}Save Calculation{% endif %}
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
const isRTL = '{{ session.get("language", "ar") }}' === 'ar';

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    // Load calculations on page load
    loadCalculations();

    // Initialize quick calculation
    calculateQuickCost();
});

// Quick Cost Calculation
function calculateQuickCost() {
    const quantity = parseFloat(document.getElementById('quick-quantity').value) || 0;
    const materialCost = parseFloat(document.getElementById('quick-material-cost').value) || 0;
    const laborCost = parseFloat(document.getElementById('quick-labor-cost').value) || 0;
    const overheadCost = parseFloat(document.getElementById('quick-overhead-cost').value) || 0;
    const profitMargin = parseFloat(document.getElementById('quick-profit-margin').value) || 0;

    const totalCost = (materialCost + laborCost + overheadCost) * quantity;
    const unitCost = quantity > 0 ? totalCost / quantity : 0;
    const profitAmount = totalCost * (profitMargin / 100);
    const sellingPrice = totalCost + profitAmount;

    document.getElementById('quick-total-cost').textContent = totalCost.toFixed(2) + ' ريال';
    document.getElementById('quick-unit-cost').textContent = unitCost.toFixed(2) + ' ريال';
    document.getElementById('quick-selling-price').textContent = sellingPrice.toFixed(2) + ' ريال';
    document.getElementById('quick-total-profit').textContent = profitAmount.toFixed(2) + ' ريال';
}

// Save Quick Calculation
function saveQuickCalculation() {
    const productName = document.getElementById('quick-product-name').value.trim();
    const quantity = parseFloat(document.getElementById('quick-quantity').value) || 0;
    const materialCost = parseFloat(document.getElementById('quick-material-cost').value) || 0;
    const laborCost = parseFloat(document.getElementById('quick-labor-cost').value) || 0;
    const overheadCost = parseFloat(document.getElementById('quick-overhead-cost').value) || 0;
    const profitMargin = parseFloat(document.getElementById('quick-profit-margin').value) || 0;

    if (!productName) {
        alert(isRTL ? 'يرجى إدخال اسم المنتج' : 'Please enter product name');
        return;
    }

    if (quantity <= 0) {
        alert(isRTL ? 'يرجى إدخال كمية صحيحة' : 'Please enter valid quantity');
        return;
    }

    const totalCost = (materialCost + laborCost + overheadCost) * quantity;
    const profitAmount = totalCost * (profitMargin / 100);
    const sellingPrice = totalCost + profitAmount;

    const calculationData = {
        product_name: productName,
        quantity: quantity,
        unit: document.getElementById('quick-unit').value,
        material_cost: materialCost,
        labor_cost: laborCost,
        overhead_cost: overheadCost,
        total_cost: totalCost,
        profit_margin: profitMargin,
        profit_amount: profitAmount,
        selling_price: sellingPrice,
        calculation_type: 'quick'
    };

    // Simulate API call for now
    alert(isRTL ? 'تم حفظ الحساب بنجاح' : 'Calculation saved successfully');
    clearQuickCalculation();
    loadCalculations();
}

// Clear Quick Calculation
function clearQuickCalculation() {
    document.getElementById('quick-product-name').value = '';
    document.getElementById('quick-quantity').value = '1';
    document.getElementById('quick-material-cost').value = '';
    document.getElementById('quick-labor-cost').value = '';
    document.getElementById('quick-overhead-cost').value = '';
    document.getElementById('quick-profit-margin').value = '20';
    calculateQuickCost();
}

// Load calculations
function loadCalculations() {
    // Simulate loading calculations
    const calculations = [];
    displayCalculations(calculations);
    updateSummaryCards(calculations);
}

// Display calculations in table
function displayCalculations(calculations) {
    const tbody = document.getElementById('calculations-tbody');

    if (calculations.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="9" class="text-center text-muted">
                    ${isRTL ? 'لا توجد حسابات محفوظة' : 'No saved calculations'}
                </td>
            </tr>
        `;
        return;
    }
}

// Update summary cards
function updateSummaryCards(calculations = []) {
    document.getElementById('total-costs').textContent = '0.00 ريال';
    document.getElementById('material-costs').textContent = '0.00 ريال';
    document.getElementById('labor-costs').textContent = '0.00 ريال';
    document.getElementById('overhead-costs').textContent = '0.00 ريال';
}

// Refresh data
function refreshData() {
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>' + (isRTL ? 'جاري التحديث...' : 'Refreshing...');

    setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = originalText;
        alert(isRTL ? 'تم تحديث البيانات بنجاح' : 'Data refreshed successfully');
        loadCalculations();
    }, 1500);
}

// Generate report
function generateReport() {
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>' + (isRTL ? 'جاري الإنشاء...' : 'Generating...');

    setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = originalText;
        alert(isRTL ? 'تم إنشاء تقرير التكاليف بنجاح' : 'Cost report generated successfully');
    }, 1500);
}

// Export data
function exportData() {
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>' + (isRTL ? 'جاري التصدير...' : 'Exporting...');

    setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = originalText;
        alert(isRTL ? 'تم تصدير البيانات بنجاح' : 'Data exported successfully');
    }, 1500);
}

// Save all data
function saveAllData() {
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>' + (isRTL ? 'جاري الحفظ...' : 'Saving...');

    setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = originalText;
        alert(isRTL ? 'تم حفظ جميع البيانات بنجاح' : 'All data saved successfully');
    }, 1500);
}

// Print report
function printReport() {
    alert(isRTL ? 'جاري إعداد التقرير للطباعة...' : 'Preparing report for printing...');
    window.print();
}

// Calculate Detailed Cost
function calculateDetailedCost() {
    alert(isRTL ? 'جاري حساب التكلفة المفصلة...' : 'Calculating detailed cost...');
}

// Save Detailed Calculation
function saveDetailedCalculation() {
    alert(isRTL ? 'تم حفظ الحساب المفصل بنجاح' : 'Detailed calculation saved successfully');
}
</script>
{% endblock %}
