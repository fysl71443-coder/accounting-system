# 🔍 دليل فحص شاشة المدفوعات والمستحقات
# Payments and Dues Screen Testing Guide

## 📋 نظرة عامة
هذا الدليل يوضح كيفية فحص شاشة المدفوعات والمستحقات للتأكد من أنها تعمل 100% قبل إنشاء التقارير.

## 🛠️ ملفات الفحص

### 1. ملفات Python
- `test_payments_dues_screen.py` - فحص شامل للخادم والصفحات
- `run_payments_test.py` - سكريبت تشغيل الفحص التلقائي

### 2. ملفات JavaScript  
- `static/js/test_payments_functions.js` - فحص وظائف JavaScript
- تم دمجه في `templates/payments_dues.html`

## 🚀 طريقة التشغيل

### الطريقة الأولى: الفحص التلقائي
```bash
python run_payments_test.py
```

### الطريقة الثانية: الفحص اليدوي
1. تشغيل الخادم:
   ```bash
   python app.py
   # أو
   python simple_start.py
   ```

2. فتح المتصفح: `http://localhost:5000/payments_dues`

3. تسجيل الدخول: `admin` / `admin123`

4. تشغيل فحص JavaScript في Console:
   ```javascript
   runPaymentsJSTests()
   ```

## ✅ قائمة الفحص

### 🔐 تسجيل الدخول
- [ ] يمكن الوصول لصفحة تسجيل الدخول
- [ ] تسجيل الدخول يعمل بالبيانات الصحيحة
- [ ] إعادة التوجيه للوحة التحكم

### 📄 شاشة المدفوعات والمستحقات
- [ ] يمكن الوصول للصفحة `/payments_dues`
- [ ] العنوان يظهر بشكل صحيح
- [ ] التبويبات الأربعة موجودة (مبيعات، مشتريات، مصروفات، رواتب)

### 🔍 الفلاتر
- [ ] فلتر المبيعات يعمل (الكل، مدفوع، جزئي، معلق)
- [ ] فلتر المشتريات يعمل
- [ ] فلتر المصروفات يعمل
- [ ] العدادات تتحدث بشكل صحيح

### 🖨️ وظائف الطباعة
- [ ] زر طباعة المبيعات يفتح النافذة
- [ ] زر طباعة المشتريات يفتح النافذة  
- [ ] زر طباعة المصروفات يفتح النافذة
- [ ] زر طباعة الرواتب يفتح النافذة

### 📅 نافذة الطباعة
- [ ] النافذة تفتح بشكل صحيح
- [ ] اختيار نوع الفاتورة يعمل
- [ ] اختيار الشهر يعمل
- [ ] اختيار الحالة يعمل
- [ ] خيار تضمين التفاصيل يعمل

### 👁️ معاينة الطباعة
- [ ] زر "معاينة" يفتح نافذة جديدة
- [ ] الصفحة تحتوي على البيانات الصحيحة
- [ ] التصميم مناسب للطباعة

### 🖨️ الطباعة المباشرة
- [ ] زر "طباعة" يفتح نافذة الطباعة
- [ ] أمر الطباعة يتم تلقائياً
- [ ] التصميم بدون ألوان

### 🧪 فحص JavaScript
- [ ] لا توجد أخطاء في Console
- [ ] جميع الوظائف معرفة
- [ ] Bootstrap محمل بشكل صحيح
- [ ] الأحداث مربوطة بشكل صحيح

## 🔧 إصلاح المشاكل الشائعة

### مشكلة: أزرار الطباعة لا تعمل
```javascript
// فحص في Console
typeof openPrintModal
// يجب أن يرجع "function"

// فحص Bootstrap
typeof bootstrap
// يجب أن يرجع "object"
```

### مشكلة: الفلاتر لا تعمل
```javascript
// فحص الفلاتر
document.getElementById('sales-status-filter')
// يجب أن يرجع عنصر HTML

// اختبار الفلتر
filterSalesTable()
```

### مشكلة: النافذة المنبثقة لا تظهر
```javascript
// فحص النافذة
document.getElementById('printModal')
// يجب أن يرجع عنصر HTML

// فحص Bootstrap Modal
new bootstrap.Modal(document.getElementById('printModal'))
```

## 📊 تفسير النتائج

### نتائج Python
- **PASS**: الاختبار نجح ✅
- **FAIL**: الاختبار فشل ❌  
- **WARN**: تحذير ⚠️

### نتائج JavaScript
- يتم عرضها في Console
- يمكن حفظها في localStorage
- يمكن عرضها بـ `console.table(getPaymentsTestResults())`

## 🎯 معايير النجاح

### للمتابعة لإنشاء التقارير يجب:
1. **معدل نجاح 80% أو أكثر** في اختبارات Python
2. **جميع الوظائف الأساسية تعمل** (فلاتر + طباعة)
3. **لا توجد أخطاء JavaScript** في Console
4. **المعاينة والطباعة تعملان** بشكل صحيح

## 🆘 الحصول على المساعدة

### إذا فشل الفحص:
1. راجع الأخطاء في Console (F12)
2. تأكد من تشغيل الخادم بشكل صحيح
3. تأكد من وجود جميع الملفات المطلوبة
4. راجع logs الخادم للأخطاء

### ملفات المساعدة:
- `payments_dues_test_report_*.json` - تقرير مفصل
- Console logs - أخطاء JavaScript
- Server logs - أخطاء الخادم

## 📞 الدعم
إذا واجهت مشاكل، يرجى:
1. تشغيل الفحص الشامل
2. حفظ نتائج الفحص
3. مراجعة الأخطاء المحددة
4. إصلاح المشاكل واحدة تلو الأخرى

---
**ملاحظة**: يجب أن تعمل جميع الوظائف 100% قبل المتابعة لإنشاء التقارير!
