#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ุงุฎุชุจุงุฑ ุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ ุงูุจุณูุทุฉ ุงูุฌุฏูุฏุฉ
Test Simple Print Buttons
"""

import requests
import webbrowser

def test_simple_print_buttons():
    """ุงุฎุชุจุงุฑ ุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ ุงูุจุณูุทุฉ"""
    print("๐จ๏ธ ุงุฎุชุจุงุฑ ุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ ุงูุจุณูุทุฉ ุงูุฌุฏูุฏุฉ")
    print("=" * 50)
    
    # ูุญุต ุงูุฎุงุฏู
    try:
        response = requests.get("http://localhost:5000", timeout=3)
        print("โ ุงูุฎุงุฏู ูุนูู")
    except:
        print("โ ุงูุฎุงุฏู ูุง ูุนูู")
        print("๐ก ุดุบู ุงูุฎุงุฏู: python run_local.py")
        return False
    
    # ุชุณุฌูู ุงูุฏุฎูู
    session = requests.Session()
    try:
        login_data = {'username': 'admin', 'password': 'admin112233'}
        response = session.post("http://localhost:5000/login", data=login_data)
        print("โ ุชู ุชุณุฌูู ุงูุฏุฎูู")
    except:
        print("โ ูุดู ุชุณุฌูู ุงูุฏุฎูู")
        return False
    
    # ูุญุต ุตูุญุฉ ุงููุฏููุนุงุช
    try:
        response = session.get("http://localhost:5000/payments_dues")
        if response.status_code == 200:
            print("โ ุตูุญุฉ ุงููุฏููุนุงุช ูุงููุณุชุญูุงุช ุชุนูู")
            
            content = response.text
            
            # ูุญุต ุงูุฃุฒุฑุงุฑ ุงูุฌุฏูุฏุฉ
            print_buttons = [
                ('printAllSales()', 'ุฒุฑ ุทุจุงุนุฉ ุฌููุน ุงููุจูุนุงุช'),
                ('printAllPurchases()', 'ุฒุฑ ุทุจุงุนุฉ ุฌููุน ุงููุดุชุฑูุงุช'),
                ('printAllExpenses()', 'ุฒุฑ ุทุจุงุนุฉ ุฌููุน ุงููุตุฑููุงุช'),
                ('printAllPayroll()', 'ุฒุฑ ุทุจุงุนุฉ ุฌููุน ุงูุฑูุงุชุจ'),
                ('ุทุจุงุนุฉ ุฌููุน ุงููุจูุนุงุช', 'ูุต ุฒุฑ ุงููุจูุนุงุช'),
                ('ุทุจุงุนุฉ ุฌููุน ุงููุดุชุฑูุงุช', 'ูุต ุฒุฑ ุงููุดุชุฑูุงุช'),
                ('ุทุจุงุนุฉ ุฌููุน ุงููุตุฑููุงุช', 'ูุต ุฒุฑ ุงููุตุฑููุงุช'),
                ('ุทุจุงุนุฉ ุฌููุน ุงูุฑูุงุชุจ', 'ูุต ุฒุฑ ุงูุฑูุงุชุจ')
            ]
            
            print("\n๐ ูุญุต ุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ:")
            buttons_found = 0
            for button, description in print_buttons:
                if button in content:
                    print(f"   โ {description}")
                    buttons_found += 1
                else:
                    print(f"   โ {description}")
            
            # ูุญุต ุงููุธุงุฆู JavaScript
            js_functions = [
                ('function printAllSales()', 'ูุธููุฉ ุทุจุงุนุฉ ุงููุจูุนุงุช'),
                ('function printAllPurchases()', 'ูุธููุฉ ุทุจุงุนุฉ ุงููุดุชุฑูุงุช'),
                ('function printAllExpenses()', 'ูุธููุฉ ุทุจุงุนุฉ ุงููุตุฑููุงุช'),
                ('function printAllPayroll()', 'ูุธููุฉ ุทุจุงุนุฉ ุงูุฑูุงุชุจ'),
                ('function openSimplePrintWindow(', 'ูุธููุฉ ูุชุญ ูุงูุฐุฉ ุงูุทุจุงุนุฉ')
            ]
            
            print("\n๐ ูุญุต ูุธุงุฆู JavaScript:")
            js_found = 0
            for func, description in js_functions:
                if func in content:
                    print(f"   โ {description}")
                    js_found += 1
                else:
                    print(f"   โ {description}")
            
            print(f"\n๐ ุงููุชุงุฆุฌ:")
            print(f"   ุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ: {buttons_found}/{len(print_buttons)}")
            print(f"   ูุธุงุฆู JavaScript: {js_found}/{len(js_functions)}")
            
            return buttons_found >= len(print_buttons) * 0.8 and js_found >= len(js_functions) * 0.8
            
        else:
            print(f"โ ุตูุญุฉ ุงููุฏููุนุงุช ูุดูุช: {response.status_code}")
            return False
            
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ูุญุต ุงูุตูุญุฉ: {e}")
        return False

def main():
    """ุงููุธููุฉ ุงูุฑุฆูุณูุฉ"""
    print("๐งช ุงุฎุชุจุงุฑ ุดุงูู ูุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ ุงูุจุณูุทุฉ")
    print("=" * 60)
    
    # ุงุฎุชุจุงุฑ ุงูุฃุฒุฑุงุฑ
    buttons_work = test_simple_print_buttons()
    
    # ูุชุญ ุงููุชุตูุญ
    print("\n๐ ูุชุญ ุงููุชุตูุญ...")
    webbrowser.open("http://localhost:5000/payments_dues")
    
    print("\n๐ ุชุนูููุงุช ุงูุงุฎุชุจุงุฑ ุงููุฏูู:")
    print("1. ุณุฌู ุงูุฏุฎูู: admin / admin112233")
    print("2. ุงุฎุชุจุฑ ุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ ูู ูู ุชุจููุจ:")
    print("   - ุชุจููุจ ุงููุจูุนุงุช: 'ุทุจุงุนุฉ ุฌููุน ุงููุจูุนุงุช'")
    print("   - ุชุจููุจ ุงููุดุชุฑูุงุช: 'ุทุจุงุนุฉ ุฌููุน ุงููุดุชุฑูุงุช'")
    print("   - ุชุจููุจ ุงููุตุฑููุงุช: 'ุทุจุงุนุฉ ุฌููุน ุงููุตุฑููุงุช'")
    print("   - ุชุจููุจ ุงูุฑูุงุชุจ: 'ุทุจุงุนุฉ ุฌููุน ุงูุฑูุงุชุจ'")
    print("3. ุชุฃูุฏ ูู ูุชุญ ูุงูุฐุฉ ุทุจุงุนุฉ ุฌุฏูุฏุฉ")
    print("4. ุชุฃูุฏ ูู ูุฌูุฏ ุงูุจูุงูุงุช ูู ุงูุชูุฑูุฑ")
    print("5. ุชุฃูุฏ ูู ุญุณุงุจ ุงููุฌููุน ุงูุฅุฌูุงูู")
    
    print("\n๐ ุงูุฑูุงุจุท:")
    print("   ุดุงุดุฉ ุงููุฏููุนุงุช: http://localhost:5000/payments_dues")
    
    print("\n๐ ุงููุฒุงูุง ุงูุฌุฏูุฏุฉ:")
    print("โ ุฃุฒุฑุงุฑ ุทุจุงุนุฉ ุจุณูุทุฉ ููุนุงูุฉ")
    print("โ ุทุจุงุนุฉ ุฌููุน ุงูููุงุชูุฑ ูู ูู ููุน")
    print("โ ุชุตููู ุทุจุงุนุฉ ุงุญุชุฑุงูู ูููุณู")
    print("โ ุฃููุงู ูููุฒุฉ ููู ููุน ูุงุชูุฑุฉ")
    print("โ ุญุณุงุจ ุงููุฌููุน ุงูุฅุฌูุงูู ุชููุงุฆูุงู")
    print("โ ูุนูููุงุช ุงูุดุฑูุฉ ูุงูุชุงุฑูุฎ")
    print("โ ุชูุณูู ููุงุณุจ ููุทุจุงุนุฉ ูุงูุญูุธ")
    print("โ ูุชุญ ูุงูุฐุฉ ุทุจุงุนุฉ ุชููุงุฆูุงู")
    
    print("\n๐ ููุฎุต ุงููุชุงุฆุฌ:")
    if buttons_work:
        print("๐ ุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ ุงูุจุณูุทุฉ ุชุนูู ุจุดูู ููุชุงุฒ!")
        print("โ ุฌููุน ุงูุฃุฒุฑุงุฑ ูุงููุธุงุฆู ูุชุงุญุฉ")
        print("โ ูููู ุทุจุงุนุฉ ุฌููุน ุฃููุงุน ุงูููุงุชูุฑ")
    else:
        print("โ๏ธ ููุงู ุจุนุถ ุงููุดุงูู ูู ุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ")
        print("๐ก ุชุฃูุฏ ูู ุชุญุฏูุซ ุงูุตูุญุฉ")
    
    print("\n๐ก ููููุฉ ุงูุงุณุชุฎุฏุงู:")
    print("1. ุงุฐูุจ ุฅูู ุฃู ุชุจููุจ (ูุจูุนุงุชุ ูุดุชุฑูุงุชุ ุฅูุฎ)")
    print("2. ุงุถุบุท ุฒุฑ 'ุทุจุงุนุฉ ุฌููุน [ุงูููุน]'")
    print("3. ุณุชูุชุญ ูุงูุฐุฉ ุฌุฏูุฏุฉ ูุน ุงูุชูุฑูุฑ")
    print("4. ุณุชุจุฏุฃ ุงูุทุจุงุนุฉ ุชููุงุฆูุงู")
    print("5. ูููู ุญูุธ ุงูุตูุญุฉ ูู PDF")
    
    print("\n๐ฏ ุงูููุงุฆุฏ:")
    print("- ุทุจุงุนุฉ ุณุฑูุนุฉ ุจุฏูู ุชุนููุฏ")
    print("- ุชูุงุฑูุฑ ููุณูุฉ ูููููุฉ")
    print("- ูุง ุญุงุฌุฉ ูุชุญุฏูุฏ ููุงุชูุฑ ูุนููุฉ")
    print("- ูุนูู ูุน ุฌููุน ุฃููุงุน ุงูููุงุชูุฑ")
    print("- ููุงุณุจ ููุทุจุงุนุฉ ูุงูุฃุฑุดูุฉ")
    
    print("=" * 60)
    
    input("\nุงุถุบุท Enter ุจุนุฏ ุงูุชูุงุก ุงูุงุฎุชุจุงุฑ...")

if __name__ == "__main__":
    main()
